# 구현 TODO (2025-09-27 회의 정리 기반)

상태 표기는 개발 진행에 따라 수시로 업데이트됩니다.

## 진행중

- [ ] 환자 선택 시 현재/과거 TDM 내역 로드 및 리스트업
  - [x] 환자별 마지막 선택 약물 복원/저장
  - [x] 환자+약물별 최근 TDM 히스토리 저장 및 최대 5개 표시
  - [x] 환자+약물 최신 결과 우선 로드 및 저장 키 분리
  - [x] 완료 TDM 보기 제약(현용법만 노출, 조정 UI 숨김)
  - [x] before 72h 메타 표시(차트 상단)

## 대기중

- [ ] 동일 약물 동시 진행 제한 로직 적용(환자-약물 1개 활성 TDM)
- [ ] 환자-약물 단위로 TDM 데이터 영속화(스토리지 스키마 정비)
- [ ] TDM 선택 시 3~4단계 저장 데이터 자동 로드
- [ ] 완료 TDM은 현용법만 노출·리포트 링크 제공
- [ ] 최신 신기능 데이터 최대 5개 노출 구현
- [ ] 정맥 주사/수액 IV 통합 및 bolus=0 주사 처리
- [ ] 투약 시간 테이블 ±1분 조정 기능 추가
- [ ] 차트 내부시간 0h 기준(첫 투약)·절대시간 스케일 적용
- [ ] 차트 틱 레이블 mm.dd HH 및 before/after 기준선 추가
- [ ] before 72h 집약 노출·after 예측 무제한 노출
- [ ] 현용법 차트에서 대조군=현용법 중복 노출 오류 수정
- [ ] 용법 조정이 현용법 시리즈를 변형하지 않도록 불변성 보장
- [ ] 72h 초과 관측/예측 데이터 및 AUC area 정상 노출
- [ ] 반코마이신 관측치(red dot) 미표기 오류 수정
- [ ] 사이클로스포린 단위 ng/mL 스케일링 오류 수정
- [ ] 용법조정 차트 환자 현용법 겹침 레이어링 개선
- [ ] 용법 조정 결과와 현용법 동시 비교 노출
- [ ] 용량/시간 범위 내 모든 후보 용법 노출(페이징/선택 지원)
- [ ] 시간 조정 옵션에 weeks 단위 UI/API 지원
- [ ] API 요청에 _before/_after tau/amount/rate/cmt 반영
- [ ] cmt 매핑 IV=1, PO=2 적용(tdm.ts 연동)
- [ ] 응답 AUCtau/AUC24h 수신·요약지표 반영
- [ ] API 응답에 before 72h 제한 메타 처리 및 노출
- [ ] 리포트 생성: 데이터 프리징·PDF 뷰어·다운로드·히스토리
- [ ] PDF 페이지에서 PK차트 데이터 바인딩 빈 값 이슈 수정
- [ ] 현용법 시뮬레이션에서 과거 TDM 리포트 링크 추가
- [ ] 혈청 크레아티닌 자동 계산 결과 적절성 검증 경고 처리
- [ ] input dataset 시간 필드 전수 점검·변환 로직 정비

## 완료

- [x] AUCtau/AUC24h 수신·요약지표 반영
- [x] API 요청에 _before/_after tau/amount/rate/cmt 반영
- [x] cmt 매핑 IV=1, PO=2 적용(tdm.ts 연동)
- [x] 동일 약물 동시 진행 제한 로직 적용(환자-약물 1개 활성 TDM)
- [x] 환자 선택 시 현재/과거 TDM 내역 로드 및 리스트업
  - [x] 환자별 마지막 선택 약물 복원/저장
  - [x] 환자+약물별 최근 TDM 히스토리 저장 및 최대 5개 표시
  - [x] 환자+약물 최신 결과 우선 로드 및 저장 키 분리
  - [x] 완료 TDM 보기 제약(현용법만 노출, 조정 UI 숨김)
  - [x] before 72h 메타 표시(차트 상단)
- [x] 차트 내부시간 0h 기준(첫 투약)·절대시간 스케일 적용
- [x] 차트 틱 레이블 mm.dd HH 및 before/after 기준선 추가
- [x] 72h 초과 관측/예측 데이터 및 AUC area 정상 노출
- [x] 현용법 차트에서 대조군=현용법 중복 노출 오류 수정
- [x] 반코마이신 관측치(red dot) 미표기 오류 수정

## 참고

- 상세 요구사항: `docs/meeting-2025-09-27-review.md`
- API 변경사항: `docs/tdm-api.md`
